# [SERIAL:2026-01-21_1406_airoom-upload-btndead] AI会議室：ボタン不動の原因切り分け強化（修正レポート）

**TO:** なべさん  
**FROM:** Rex  
**DATE(JST):** 2026-01-21 14:06:21 JST  
**VERSION:** v17.0.7-upload-btndead

---

## 1) 変更点（3〜7行）

1. **debug=1時に画面上部バナーに「JS起動OK」を表示**（JSが動いていることを確実に見える化）
2. **debug=1時に画面上部バナーに「最後に捕まえたclick」を表示**（クリックイベントが拾えているかを確認）
3. **クリックキャプチャ（capture=true）で拾えたclickを記録・表示**（拾えてるのに動かない＝ハンドラ側、拾えない＝上に何か被ってる/無効化されてる）
4. **VERSION/BUILDを確実に表示**（debug=1時に画面・コンソール両方に出力）
5. **イベントハンドラの結びつきを詳細デバッグ**（debug=1時にconsole.tableで一覧表示）
6. **__bindOnclickCompat__初期化エラーを画面内ログに表示**（エラー発生時に画面下部のデバッグコンソールに表示）
7. **debug=1時のみ、グローバルクリックキャプチャリスナー追加**（透明オーバーレイ・pointer-events・z-index検出）

---

## 2) 作業ブランチ

`fix/button-dead-compat`

---

## 3) アップ対象ファイル

- `Code.gs`
- `index.html`

---

## 4) 期待される動作（debug=1時）

### 画面上部バナーに以下が表示される：
```
JS起動OK | v17.0.7-upload-btndead | BUILD=2026-01-21_1406_airoom-upload-btndead | 最後のclick: BUTTON#xxx | debug=1
```

### コンソールに以下が表示される：
- `[AI会議室] JS起動OK | VERSION: v17.0.7-upload-btndead BUILD: 2026-01-21_1406_airoom-upload-btndead`
- `[クリックキャプチャ] 捕まえたclick: BUTTON#xxx`（クリック時に表示）

---

## 5) なべさんへの「最初の1アクション」

1. **ChromeでGASを開く** → GitHub AssistantでPull
2. **デプロイ** → 新しいデプロイ
3. **`.../exec?b=2026-01-21_1406_airoom-upload-btndead&debug=1` を開いてスクショ1枚**

---

## 6) 動作確認項目

### A. 「最新版を見ていない」系の確認
- ✅ 画面左上に黒いバナーが表示され、`JS起動OK | v17.0.7-upload-btndead | BUILD=2026-01-21_1406_airoom-upload-btndead | debug=1`と表示される
- ✅ ブラウザの開発者ツール（F12）→コンソールに`[AI会議室] JS起動OK | VERSION: v17.0.7-upload-btndead BUILD: 2026-01-21_1406_airoom-upload-btndead`が表示される

### B. 「イベントが死んでる」系の確認
- ✅ ボタンをクリックすると、画面上部バナーに「最後のclick: BUTTON#xxx」が表示される
- ✅ コンソールに`[クリックキャプチャ] 捕まえたclick: BUTTON#xxx`が表示される
- ✅ ログ / 設定 / リセット / オート / マニュアル / 左の各ボタン（画像/貼付/Code貼付枠/クリア/GitHub）が反応するか
- ✅ ボタン押下で ReferenceError が出ないか

---

## 7) UI変更なしの確認

✅ 見た目：変更なし  
✅ 配置：変更なし  
✅ 文言：変更なし  
✅ 要素追加：なし（内部のデバッグ機能のみ追加）

---

以上、お願いします。
